<div class="container-fluid">
  <div class="row border-bottom">
    <div class="col-sm-12 col-md-4 col-lg-10">
      <h5>Novo contrato: {{cliente.nome}}</h5>
    </div>
    <div class="col-sm-12 col-md-4 col-lg-2">
      <button class="btn btn-sm form-control text-light bg-primary" (click)="listar()">Listagem</button>
    </div>
  </div>
  <div class="row mt-3">
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="operadoraOption">Operadora</label>
      <select class="form-control" [(ngModel)]="ope_id" id="operadoraOption" (change)="listarModalidades()">
        <option *ngFor="let operadora of operadoras" [ngValue]="operadora.id">
          {{operadora.nome}}
        </option>
      </select>
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="modalidadeOption">Modalidades de plano</label>
      <select class="form-control" [(ngModel)]="contrato.mop_id" id="modalidadeOption">
        <option *ngFor="let modalidadePlano of modalidadesPlano" [ngValue]="modalidadePlano.id">
          {{modalidadePlano.nome}}
        </option>
      </select>
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="administradoraOption">Administradoras</label>
      <select class="form-control" [(ngModel)]="contrato.adm_id" id="administradoraOption">
        <option *ngFor="let administradora of administradoras" [ngValue]="administradora.id">
          {{administradora.nome}}
        </option>
      </select>
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="tipoContratoOption">Tipos de contrato</label>
      <select class="form-control" [(ngModel)]="contrato.tco_id" id="tipoContratoOption"
        (change)="listarClassesContrato()">
        <option *ngFor="let tipoContrato of tiposContrato" [ngValue]="tipoContrato.id">
          {{tipoContrato.nome}}
        </option>
      </select>
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="classeDeContratoOption">Classes de contrato</label>
      <select class="form-control" [(ngModel)]="contrato.clc_id" id="classeDeContratoOption"
        (change)="listarClassesContrato()">
        <option *ngFor="let classeContrato of classesContrato" [ngValue]="classeContrato.id">
          {{classeContrato.nome}}
        </option>
      </select>
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="numeroContrato">Numero do contrato</label>
      <input id="numeroContrato" [(ngModel)]="contrato.numero_contrato" class="form-control" type="text">
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="valorContrato">Valor do contrato</label>
      <input id="valorContrato" [(ngModel)]="contrato.valor" class="form-control" type="number" placeholder="R$...">
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="valorDesconto">Valor do desconto</label>
      <input id="valorDesconto" [(ngModel)]="contrato.valor_desconto" class="form-control" type="number"
        placeholder="R$...">
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="inicioVigencia">Início Vigência</label>
      <input id="inicioVigencia" [(ngModel)]="contrato.inicio_vigencia" class="form-control" type="date">
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="dataAssinaturaContrato">Dada da Assinatura</label>
      <input id="dataAssinaturaContrato" [(ngModel)]="contrato.data_assinatura_contrato" class="form-control"
        type="date">
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-3">
      <label for="usuarioOption">Corretor/Usuário</label>
      <select class="form-control" [(ngModel)]="contrato.usr_id" id="usuarioOption">
        <option *ngFor="let usuario of usuarios" [ngValue]="usuario.id">
          {{usuario.nome}}
        </option>
      </select>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-4 col-lg-12 mt-3 border-bottom">
      <button class="btn btn-sm btn-success text-light float-right col-sm-12 col-md-4 col-lg-2"
        (click)="salvar()">Concluir</button>
    </div>
  </div>
  <div class="row">
    <label for="">Valores recebidos</label>
  </div>
  <div class="row border-bottom">
    <div class="form-group col-sm-12 col-md-4 col-lg-2">
      <label for="tipoPagamentoOption">Tipos de Pagamento</label>
      <select class="form-control" [(ngModel)]="comissao.tip_id" id="tipoPagamentoOption">
        <option *ngFor="let tipoPagamento of tiposPagamento" [ngValue]="tipoPagamento.id">
          {{tipoPagamento.nome}}
        </option>
      </select>
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-2">
      <label for="tipoComissaoOption">Tipos de Comissão</label>
      <select class="form-control" [(ngModel)]="comissao.tcm_id" id="tipoComissaoOption" (change)="calcularComissao()">
        <option *ngFor="let tipoComissao of tiposComissao" [ngValue]="tipoComissao.id">
          {{tipoComissao.nome}}
        </option>
      </select>
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-2">
      <label for="valorComissao">Valor</label>
      <input class="form-control" type="number" [(ngModel)]="comissao.valor" placeholder="valor recebido...">
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-2">
      <label for="dataFaturamento">Dada do faturamento</label>
      <input id="dataFaturamento" [(ngModel)]="comissao.data_faturamento" class="form-control" type="date">
    </div>
    <div class="form-group col-sm-12 col-md-4 col-lg-2">
      <label for="adicionarComissao">Adicionar</label>
      <button class="btn btn-sm btn-warning text-light form-control" (click)="adicionarComissao()"
        id="adicionarComissao"><i class="fa fa-sm fa-plus-square"></i></button>
    </div>
  </div>
  <div class="row mt-3">
    <table class="table table-striped table-hover">
      <thead class="thead-light">
        <tr class="row">
          <th class="col-sm-12 col-md-4 col-lg-3" scope="col">Valor</th>
          <th class="col-sm-12 col-md-4 col-lg-3" scope="col">Tipo de pagamento</th>
          <th class="col-sm-12 col-md-4 col-lg-3" scope="col">Tipo de comissão</th>
          <th class="col-sm-12 col-md-4 col-lg-2" scope="col">Data do faturamento</th>
          <th class="col-sm-12 col-md-4 col-lg-1" scope="col">Excluir</th>
        </tr>
      </thead>
      <tbody>
        <div class="scrollable col-sm-12 col-md-4 col-lg-12">
          <tr class="row" *ngFor="let comissaoListagem of comissoesListagem">
            <td class="col-sm-12 col-md-4 col-lg-3 float-left">{{ comissaoListagem.valor | currency:'BRL' }}</td>
            <td class="col-sm-12 col-md-4 col-lg-3 float-left">{{ comissaoListagem.tip_nome  }}</td>
            <td class="col-sm-12 col-md-4 col-lg-3 float-left">{{ comissaoListagem.tcm_nome  }}</td>
            <td class="col-sm-12 col-md-4 col-lg-2 float-left">
              {{ comissaoListagem.data_faturamento | date:'dd-MM-yyyy'}}
            </td>
            <td class="col-sm-12 col-md-4 col-lg-1 float-left"><button class="btn btn-sm text-light bg-danger"
                (click)="removerComissao(comissaoListagem)">Excluir</button></td>
          </tr>
        </div>
      </tbody>
    </table>
  </div>

</div>

<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="ball-atom" [fullScreen]="true">
  <p style="color: white"> Processando... </p>
</ngx-spinner>